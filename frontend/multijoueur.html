<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.socket.io https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; font-src 'self' https://cdnjs.cloudflare.com; connect-src 'self' ws://questionpourunchampion-backend.onrender.com wss://questionpourunchampion-backend.onrender.com https://questionpourunchampion-backend.onrender.com https://cdn.socket.io; img-src 'self' data: https://upload.wikimedia.org https://commons.wikimedia.org;"
    />
    <title>Multijoueur - Question pour un Champion</title>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <!-- ============================================ -->
    <!-- ÉCRAN ACCUEIL MULTIJOUEUR -->
    <!-- ============================================ -->
    <section id="multijoueur" class="ecran actif">
      <div class="contenu">
        <header>
          <h1>Mode Multijoueur</h1>
          <h2>Affrontez vos amis en temps réel</h2>
        </header>

        <div class="multijoueur-options">
          <!-- CRÉER UNE PARTIE -->
          <div class="option-creer">
            <h3><i class="fas fa-plus-circle"></i> Créer une partie</h3>

            <div class="form-group">
              <label for="nom-createur">Votre nom</label>
              <input
                type="text"
                id="nom-createur"
                placeholder="Ex: Julien"
                maxlength="20"
              />
            </div>

            <div class="parametres-partie">
              <h4>Paramètres du jeu</h4>

              <div class="groupe-parametre">
                <label for="multi-nombre-questions">Nombre de questions</label>
                <select id="multi-nombre-questions" class="select-choix">
                  <option value="5">5 questions</option>
                  <option value="10" selected>10 questions</option>
                  <option value="15">15 questions</option>
                  <option value="20">20 questions</option>
                </select>
              </div>

              <div class="groupe-parametre">
                <label for="multi-duree-question">Temps par question (s)</label>
                <select id="multi-duree-question" class="select-choix">
                  <option value="10">10 secondes</option>
                  <option value="15">15 secondes</option>
                  <option value="20">20 secondes</option>
                  <option value="25">25 secondes</option>
                  <option value="30" selected>30 secondes</option>
                </select>
              </div>

              <div class="groupe-parametre">
                <label for="multi-duree-reponse">Temps pour répondre (s)</label>
                <select id="multi-duree-reponse" class="select-choix">
                  <option value="10">10 secondes</option>
                  <option value="15" selected>15 secondes</option>
                  <option value="20">20 secondes</option>
                </select>
              </div>

              <div class="groupe-parametre">
                <label for="multi-mode">Mode multijoueur</label>
                <select id="multi-mode" class="select-choix">
                  <option value="spectator" selected>
                    PC Hôte — joueurs au téléphone (l'hôte ne joue pas)
                  </option>
                  <option value="classic">
                    Mode Classique — chaque joueur sur son téléphone (pas d'hôte)
                  </option>
                </select>
              </div>
            </div>

            <button id="btn-creer-partie" class="bouton bouton-principal">
              <i class="fas fa-gamepad"></i> Créer la partie
            </button>

            <!-- CODE DE PARTIE -->
            <div id="code-partie-container" class="hidden">
              <div class="code-partie">
                <p>Code de la partie :</p>
                <h2 id="code-partie">XXXXXX</h2>
                <p>Partagez ce code avec vos amis !</p>
              </div>

              <!-- QR CODE -->
              <div
                class="code-partie"
                id="qr-partie-container"
                aria-label="QR code de connexion"
              >
                <p>QR code (connexion rapide) :</p>
                <div
                  id="qr-code"
                  style="display: flex; justify-content: center"
                ></div>
                <p class="info">Scannez pour rejoindre sur téléphone.</p>
              </div>

              <!-- LISTE JOUEURS -->
              <div class="joueurs-salle">
                <h3>Joueurs en attente :</h3>
                <div id="liste-joueurs-salle"></div>
                <button
                  id="btn-demarrer-partie"
                  class="bouton bouton-principal"
                  disabled
                >
                  <i class="fas fa-play"></i> Démarrer (0/4)
                </button>
              </div>
            </div>
          </div>

          <div class="separateur-vertical"></div>

          <!-- REJOINDRE UNE PARTIE -->
          <div class="option-rejoindre">
            <h3><i class="fas fa-users"></i> Rejoindre une partie</h3>

            <div class="form-group">
              <label for="nom-joueur">Votre nom</label>
              <input
                type="text"
                id="nom-joueur"
                placeholder="Votre prénom"
                maxlength="20"
              />
            </div>

            <div class="form-group">
              <label for="code-rejoindre">Code de la partie</label>
              <input
                type="text"
                id="code-rejoindre"
                placeholder="6 caractères"
                maxlength="6"
                style="text-transform: uppercase"
              />
            </div>

            <button id="btn-rejoindre-partie" class="bouton bouton-secondaire">
              <i class="fas fa-sign-in-alt"></i> Rejoindre
            </button>

            <!-- SALLE D'ATTENTE -->
            <div id="salle-attente" class="hidden">
              <div class="info-salle">
                <p>Partie : <strong id="code-salle-jointe"></strong></p>
                <p>Hôte : <strong id="nom-hote"></strong></p>
              </div>
              <div id="joueurs-attente"></div>
              <p class="message-attente">
                <i class="fas fa-spinner fa-spin"></i> En attente du début de la
                partie...
              </p>
            </div>
          </div>
        </div>

        <div class="actions">
          <a
            href="index.html"
            class="bouton bouton-secondaire"
            style="text-decoration: none; display: inline-block"
          >
            <i class="fas fa-arrow-left"></i> Retour à l'accueil
          </a>
        </div>
      </div>
    </section>

    <!-- ============================================ -->
    <!-- ÉCRAN JEU MULTIJOUEUR -->
    <!-- ============================================ -->
    <section id="jeu-multijoueur" class="ecran">
      <div class="contenu contenu-large">
        <header class="header-multijoueur">
          <div class="info-partie">
            <span id="info-question-multi">Question 1/10</span>
            <div class="chrono-multijoueur" aria-label="Chronomètre question">
              <span id="temps-multijoueur">30</span>
              <span>secondes</span>
            </div>
            <span id="joueurs-connectes">0 joueurs</span>
          </div>
        </header>

        <!-- VUE HÔTE (PC) - Mode spectateur -->
        <div id="vue-hote-multi" class="vue-multi">
          <div class="scores-multijoueur" id="grille-scores-multi"></div>

          <div class="question-multijoueur">
            <h2 id="question-multijoueur">Question...</h2>
          </div>

          <div
            class="options-host"
            id="options-host-multi"
            aria-label="Options de réponse (hôte)"
          ></div>

          <!-- PANNEAU HÔTE JOUEUR -->
          <div
            id="host-player-panel"
            class="host-player-panel hidden"
            aria-label="Panneau joueur hôte"
          >
            <div class="mobile-buzzer-zone">
              <button
                id="btn-buzz-host"
                class="bouton-buzzer-mobile"
                type="button"
              >
                BUZZ
              </button>
              <p id="etat-buzzer-host" class="texte-secondaire">
                Appuyez pour buzzer.
              </p>
            </div>
            <div
              class="options-reponse-multi options-reponse-mobile"
              id="options-reponse-hostlocal"
            ></div>
          </div>

          <!-- ÉCRAN RÉPONSE -->
          <div id="ecran-reponse-multi" class="hidden" aria-live="polite">
            <div class="reponse-header">
              <h2><span id="nom-repondant-multi">Joueur</span> va répondre</h2>
              <div
                class="chrono-reponse-multi"
                aria-label="Chronomètre réponse"
              >
                <span id="temps-reponse-multi">15</span>
                <span>secondes</span>
              </div>
            </div>
          </div>

          <!-- ÉCRAN RÉSULTAT -->
          <div id="ecran-resultat-multi" class="hidden">
            <h2>Résultat</h2>
            <p id="resultat-multi-bonne" class="reponse-correcte">
              Réponse correcte : ...
            </p>

            <div
              id="resultat-multi-illustration"
              class="illustration-container hidden"
            >
              <img
                id="resultat-multi-image"
                alt="Illustration"
                loading="lazy"
              />
              <p
                id="resultat-multi-description"
                class="illustration-description"
              ></p>
            </div>

            <div class="resultat-actions">
              <button
                id="btn-resultat-multi-continuer"
                class="bouton bouton-principal"
              >
                Question suivante
              </button>
              <a
                href="index.html"
                class="bouton bouton-secondaire"
                style="text-decoration: none; display: inline-block"
                >Menu principal</a
              >
            </div>
          </div>
        </div>

        <!-- VUE MODE CLASSIQUE - Tous sur le même écran -->
        <div id="vue-classique-multi" class="vue-multi hidden">
          <div class="classique-question-zone">
            <div class="question-multijoueur">
              <h2 id="question-classique">Question...</h2>
            </div>
            
            <div class="classique-options" id="options-classique"></div>
          </div>

          <div class="classique-buzzers-grid" id="buzzers-classique"></div>

          <!-- ÉCRAN RÉSULTAT CLASSIQUE -->
          <div id="ecran-resultat-classique" class="hidden">
            <h2>Résultat</h2>
            <p id="resultat-classique-info" class="reponse-correcte"></p>
            <div id="resultat-classique-illustration" class="illustration-container hidden">
              <img id="resultat-classique-image" alt="Illustration" loading="lazy" />
              <p id="resultat-classique-description" class="illustration-description"></p>
            </div>
            <div class="resultat-actions">
              <button id="btn-resultat-classique-continuer" class="bouton bouton-principal">
                Question suivante
              </button>
            </div>
          </div>
        </div>

        <!-- VUE JOUEUR (TÉLÉPHONE) -->
        <div id="vue-joueur-multi" class="vue-multi hidden">
          <!-- Question visible en mode classique -->
          <div id="question-joueur-container" class="question-joueur-zone hidden">
            <div class="question-multijoueur">
              <h2 id="question-joueur">Question...</h2>
            </div>
          </div>

          <div class="mobile-buzzer-zone">
            <button
              id="btn-buzz-player"
              class="bouton-buzzer-mobile"
              type="button"
            >
              BUZZ
            </button>
            <p id="etat-buzzer-player" class="texte-secondaire">
              Appuyez pour buzzer dès que vous êtes prêt.
            </p>
          </div>

          <div
            class="options-reponse-multi options-reponse-mobile"
            id="options-reponse-multi"
          ></div>

          <!-- RÉSULTAT JOUEUR -->
          <div
            id="resultat-joueur-multi"
            class="hidden resultat-joueur"
            aria-live="polite"
          >
            <h2 id="titre-resultat-joueur">Résultat</h2>
            <p id="resultat-joueur-correct" class="texte-secondaire"></p>
            <div class="illustration-container">
              <img
                id="resultat-joueur-image"
                alt="Illustration"
                loading="lazy"
              />
              <p
                id="resultat-joueur-description"
                class="illustration-description"
              ></p>
            </div>
            <div class="scoreboard-joueur">
              <h3>Points</h3>
              <div id="liste-scores-joueur" class="liste-scores"></div>
            </div>
            <p id="compte-a-rebours-prochaine" class="texte-secondaire"></p>
          </div>

          <!-- FIN PARTIE JOUEUR -->
          <div
            id="fin-partie-joueur"
            class="hidden fin-partie-joueur"
            aria-live="polite"
          >
            <h2>Partie terminée</h2>
            <p class="texte-secondaire">
              Merci d'avoir joué. Vous pouvez fermer cette page.
            </p>
            <a
              href="index.html"
              class="bouton bouton-secondaire"
              style="text-decoration: none; display: inline-block"
              >Menu principal</a
            >
          </div>
        </div>
      </div>
    </section>

    <!-- ============================================ -->
    <!-- ÉCRAN RÉSULTATS FINAUX -->
    <!-- ============================================ -->
    <section id="resultat-multijoueur" class="ecran">
      <div class="contenu">
        <header>
          <h1>Résultats - Multijoueur</h1>
          <h2>Classement final</h2>
        </header>

        <div class="resultat-question">
          <h2 id="titre-resultat-multi">Fin de partie</h2>
          <p id="sous-titre-resultat-multi">Bravo à tous les joueurs</p>
        </div>

        <div class="scores" id="grille-scores-resultat-multi"></div>

        <div class="actions">
          <a
            href="index.html"
            class="bouton bouton-principal"
            style="text-decoration: none; display: inline-block"
          >
            <i class="fas fa-home"></i> Retour à l'accueil
          </a>
        </div>
      </div>
    </section>

    <!-- ============================================ -->
    <!-- SCRIPTS -->
    <!-- ============================================ -->
    <script src="script.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="multijoueur-game.js"></script>
  </body>
</html>
